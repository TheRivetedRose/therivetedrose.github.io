---
import PageLayout from "../layouts/PageLayout.astro";
import ProjectCard from "../components/ProjectCard.astro";
import PostCard from "../components/PostCard.astro";
import Typewriter from "../components/Typewriter.astro";
import GlitchName from "../components/GlitchName.astro";
import ToolCard from "../components/ToolCard.astro";
import GitHubIcon from "../components/icons/GitHubIcon.astro";
import LinkedInIcon from "../components/icons/LinkedInIcon.astro";
import RevealOnScroll from "../components/RevealOnScroll.astro";
import { getCollection } from "astro:content";
import { tools } from "../data/tools";
import { languages } from "../data/languages";

const projects = await getCollection("projects");
const featuredProjects = projects.filter((p) => p.data.featured).slice(0, 3);
const blogPosts = (await getCollection("blog"))
  .sort((a, b) => b.data.pubDate.getTime() - a.data.pubDate.getTime())
  .slice(0, 3);

const typewriterPhrases = [
  "Cybersecurity Student",
  "Aspiring SOC Analyst",
  "Detection & Response Enthusiast",
  "Security Documentation Specialist",
  "Security-Focused Systems Builder",
  "Home Lab Security Architect",
];

const typewriterSubheadlines = [
  "TCP/IP Fundamentals • Linux CLI Proficiency • Identity & Access Concepts • Security Control Implementation",
  "SIEM Experimentation • Alert Triage Practice • NIST Incident Response • MITRE ATT&CK Mapping",
  "Log Collection • Packet Analysis • Vulnerability Scanning • Network Traffic Analysis",
  "Incident Documentation • After-Action Reporting • Structured Technical Reporting",
  "System Hardening • Firewall Configuration • Access Control Implementation • Risk & Control Assessment",
  "Isolated VM Environments • NAT Segmentation • Controlled Attack Testing • Log Generation Pipelines",
];
---

<PageLayout
  title="Home"
  description="TheRivetedRose — Portfolio, technical writing, and security lab projects"
>
  <section
    class="hero relative overflow-hidden border-b border-rosie-navy/50 bg-rosie-navy polka-dots"
  >
    <div class="mx-auto max-w-5xl px-4 py-24 sm:px-6 lg:px-8">
      <RevealOnScroll>
        <h1
          class="mb-4 text-4xl font-bold tracking-tight text-white sm:text-5xl lg:text-6xl"
        >
          Hi, I'm <GlitchName client:load class="text-rosie-yellow" />
        </h1>
        <div class="text-xl text-white/85">
          <Typewriter
            client:load
            phrases={typewriterPhrases}
            subheadlines={typewriterSubheadlines}
            subheadlineClass="text-white/70"
          />
        </div>
        <p class="mt-6 max-w-2xl text-white/75">
          I build secure systems, document architecture, and experiment with lab
          environments. This site showcases my projects and technical writing.
        </p>
        <div class="mt-8 flex gap-4">
          <a
            href="/projects/"
            class="inline-flex items-center justify-center rounded-lg bg-rosie-yellow px-4 py-2 text-sm font-medium text-rosie-navy transition-colors hover:bg-rosie-yellow/90 focus:outline-none focus:ring-2 focus:ring-rosie-yellow focus:ring-offset-2 focus:ring-offset-rosie-navy"
          >
            View Projects
          </a>
          <a
            href="/about/"
            class="inline-flex items-center justify-center rounded-lg border-2 border-rosie-red bg-rosie-red px-4 py-2 text-sm font-medium text-white transition-colors hover:bg-rosie-red/90 focus:outline-none focus:ring-2 focus:ring-rosie-red focus:ring-offset-2 focus:ring-offset-rosie-navy"
          >
            About Me
          </a>
        </div>
      </RevealOnScroll>
    </div>
  </section>

  <script>
    document.addEventListener("typewriter-complete", () => {
      document.dispatchEvent(new CustomEvent("glitch-name-trigger"));
    });
    document.addEventListener("glitch-name-complete", () => {
      document.dispatchEvent(new CustomEvent("typewriter-restart"));
    });
  </script>

  <section class="mx-auto max-w-5xl px-4 py-16 sm:px-6 lg:px-8">
    <RevealOnScroll>
      <h2 class="section-heading-rosie mb-8">About</h2>
      <p class="max-w-2xl text-muted">
        I focus on security, virtualization, and technical documentation. My
        work spans dual-boot lab architectures, network segmentation, packet
        analysis, and log collection. I believe in repeatable deployments and
        clear documentation.
      </p>
      <a href="/about/" class="btn-secondary mt-4">Learn more</a>
    </RevealOnScroll>
  </section>

  <section class="border-t border-rosie-navy/20 bg-surface-elevated polka-dots">
    <div class="mx-auto max-w-5xl px-4 py-16 sm:px-6 lg:px-8">
      <RevealOnScroll>
        <h2 class="section-heading-rosie mb-8">Languages</h2>
        <div class="grid grid-cols-2 gap-4 sm:grid-cols-3 md:grid-cols-4">
          {languages.map((lang) => (
            <ToolCard
              name={lang.name}
              path={lang.icon.path}
              color={lang.icon.hex}
            />
          ))}
        </div>
      </RevealOnScroll>
    </div>
  </section>

  <section class="mx-auto max-w-5xl px-4 py-16 sm:px-6 lg:px-8">
    <RevealOnScroll>
      <h2 class="section-heading-rosie mb-8">Tools & Platforms</h2>
      <div class="grid grid-cols-2 gap-4 sm:grid-cols-3 md:grid-cols-4">
        {tools.map((tool) => (
          <ToolCard
            name={tool.name}
            path={tool.icon.path}
            color={tool.icon.hex}
          />
        ))}
      </div>
    </RevealOnScroll>
  </section>

  <section class="mx-auto max-w-5xl px-4 py-16 sm:px-6 lg:px-8">
    <RevealOnScroll>
      <h2 class="section-heading-rosie mb-8">Featured Projects</h2>
      <div class="grid gap-6 sm:grid-cols-2 lg:grid-cols-3">
        {
          featuredProjects.length > 0
            ? featuredProjects.map((project) => (
                <ProjectCard
                  slug={project.slug}
                  title={project.data.title}
                  summary={project.data.summary}
                  tags={project.data.tags}
                  featured={project.data.featured}
                />
              ))
            : projects
                .slice(0, 3)
                .map((project) => (
                  <ProjectCard
                    slug={project.slug}
                    title={project.data.title}
                    summary={project.data.summary}
                    tags={project.data.tags}
                    featured={project.data.featured}
                  />
                ))
        }
      </div>
      <a href="/projects/" class="btn-secondary mt-8">All projects</a>
    </RevealOnScroll>
  </section>

  <section class="border-t border-rosie-navy/20 bg-surface-elevated polka-dots">
    <div class="mx-auto max-w-5xl px-4 py-16 sm:px-6 lg:px-8">
      <RevealOnScroll>
        <h2 class="section-heading-rosie mb-8">Latest Blog</h2>
        <div class="grid gap-6 sm:grid-cols-2 lg:grid-cols-3">
          {
            blogPosts.map((post) => (
              <PostCard
                slug={post.slug}
                title={post.data.title}
                summary={post.data.summary}
                pubDate={post.data.pubDate}
                tags={post.data.tags}
              />
            ))
          }
        </div>
        {
          blogPosts.length > 0 && (
            <a href="/blog/" class="btn-secondary mt-8">
              All posts
            </a>
          )
        }
      </RevealOnScroll>
    </div>
  </section>

  <section class="mx-auto max-w-5xl px-4 py-16 sm:px-6 lg:px-8">
    <RevealOnScroll>
      <h2 class="section-heading-rosie mb-8">Contact</h2>
      <p class="max-w-2xl text-muted">Checkout my work on GitHub.</p>
      <a
        href="https://github.com/therivetedrose"
        class="btn-github mt-4"
        target="_blank"
        rel="noopener noreferrer"
      >
        <GitHubIcon size={18} />
        GitHub
      </a>
      <p class="mt-6 text-muted">Reach out to me on LinkedIn.</p>
      <a
        href="https://www.linkedin.com/in/rosefr"
        class="btn-linkedin mt-4"
        target="_blank"
        rel="noopener noreferrer"
      >
        <LinkedInIcon size={18} />
        LinkedIn
      </a>
    </RevealOnScroll>
  </section>
</PageLayout>
