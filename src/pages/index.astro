---
import PageLayout from "../layouts/PageLayout.astro";
import ProjectCard from "../components/ProjectCard.astro";
import PostCard from "../components/PostCard.astro";
import Typewriter from "../components/Typewriter.astro";
import GlitchName from "../components/GlitchName.astro";
import ResumeSection from "../components/ResumeSection.astro";
import TechStackTabs from "../components/TechStackTabs.astro";
import GitHubIcon from "../components/icons/GitHubIcon.astro";
import LinkedInIcon from "../components/icons/LinkedInIcon.astro";
import RevealOnScroll from "../components/RevealOnScroll.astro";
import HeroHexRivets from "../components/HeroHexRivets.astro";
import { getCollection } from "astro:content";

const projects = await getCollection("projects");
const featuredProjects = projects.filter((p) => p.data.featured).slice(0, 3);
const blogPosts = (await getCollection("blog"))
  .sort((a, b) => b.data.pubDate.getTime() - a.data.pubDate.getTime())
  .slice(0, 3);

const typewriterPhrases = [
  "Cybersecurity Student",
  "Aspiring SOC Analyst",
  "Detection & Response Enthusiast",
  "Security Documentation Specialist",
  "Security-Focused Systems Builder",
  "Home Lab Security Architect",
];

const typewriterSubheadlines = [
  "TCP/IP Fundamentals • Linux CLI Proficiency • Identity & Access Concepts • Security Control Implementation",
  "SIEM Experimentation • Alert Triage Practice • NIST Incident Response • MITRE ATT&CK Mapping",
  "Log Collection • Packet Analysis • Vulnerability Scanning • Network Traffic Analysis",
  "Incident Documentation • After-Action Reporting • Structured Technical Reporting",
  "System Hardening • Firewall Configuration • Access Control Implementation • Risk & Control Assessment",
  "Isolated VM Environments • NAT Segmentation • Controlled Attack Testing • Log Generation Pipelines",
];
---

<PageLayout
  title="Home"
  description="TheRivetedRose — Portfolio, technical writing, and security lab projects"
>
  <section class="hero relative overflow-hidden bg-rosie-navy">
    <HeroHexRivets />
    <div class="relative z-10 mx-auto max-w-5xl px-4 py-24 sm:px-6 lg:px-8">
      <RevealOnScroll>
        <h1
          class="mb-4 text-4xl font-bold tracking-tight text-black dark:text-white sm:text-5xl lg:text-6xl"
        >
          Hi, I'm <GlitchName client:load class="text-rosie-yellow" />
        </h1>
        <div class="min-h-[8rem] text-xl text-black dark:text-white/85">
          <Typewriter
            client:load
            phrases={typewriterPhrases}
            subheadlines={typewriterSubheadlines}
            subheadlineClass="text-black dark:text-white/70"
          />
        </div>
        <p class="mt-6 max-w-2xl text-black dark:text-white/75">
          I build secure systems, document architecture, and experiment with lab
          environments. This site showcases my projects and technical writing.
        </p>
        <div class="mt-8 flex gap-4">
          <a
            href="/projects/"
            class="btn-solid-yellow focus:ring-offset-rosie-navy"
          >
            View Projects
          </a>
          <a
            href="/about/"
            class="btn-solid-red border-2 border-rosie-red focus:ring-offset-rosie-navy"
          >
            About Me
          </a>
        </div>
      </RevealOnScroll>
    </div>
  </section>

  <script>
    document.addEventListener("typewriter-complete", () => {
      document.dispatchEvent(new CustomEvent("glitch-name-trigger"));
    });
    document.addEventListener("glitch-name-complete", () => {
      document.dispatchEvent(new CustomEvent("typewriter-restart"));
    });
  </script>

  <section class="mx-auto max-w-5xl px-4 py-16 sm:px-6 lg:px-8">
    <RevealOnScroll>
      <h2 class="section-heading-rosie sticky-section-heading sticky-section-heading--surface mb-8">About</h2>
      <p class="max-w-2xl text-muted">
        I focus on security, virtualization, and technical documentation. My
        work spans dual-boot lab architectures, network segmentation, packet
        analysis, and log collection. I believe in repeatable deployments and
        clear documentation.
      </p>
      <a href="/about/" class="btn-solid-red mt-4">Learn More</a>
    </RevealOnScroll>
  </section>

  <ResumeSection />

  <TechStackTabs />

  <section class="border-t border-rosie-navy/20 bg-surface-elevated">
    <div class="mx-auto max-w-5xl px-4 py-16 sm:px-6 lg:px-8">
    <RevealOnScroll>
      <h2 class="section-heading-rosie sticky-section-heading mb-8">Featured Projects</h2>
      <div class="grid gap-6 sm:grid-cols-2 lg:grid-cols-3">
        {
          featuredProjects.length > 0
            ? featuredProjects.map((project) => (
                <ProjectCard
                  slug={project.slug}
                  title={project.data.title}
                  summary={project.data.summary}
                  tags={project.data.tags}
                  featured={project.data.featured}
                  pubDate={project.data.pubDate}
                  updatedDate={project.data.updatedDate}
                />
              ))
            : projects
                .slice(0, 3)
                .map((project) => (
                  <ProjectCard
                    slug={project.slug}
                    title={project.data.title}
                    summary={project.data.summary}
                    tags={project.data.tags}
                    featured={project.data.featured}
                  />
                ))
        }
      </div>
      <a href="/projects/" class="btn-solid-yellow mt-8">All Projects</a>
    </RevealOnScroll>
    </div>
  </section>

  <section class="border-t border-rosie-navy/20 bg-surface-elevated">
    <div class="mx-auto max-w-5xl px-4 py-16 sm:px-6 lg:px-8">
      <RevealOnScroll>
        <h2 class="section-heading-rosie sticky-section-heading mb-8">Latest Blog</h2>
        <div class="grid gap-6 sm:grid-cols-2 lg:grid-cols-3">
          {
            blogPosts.map((post) => (
              <PostCard
                slug={post.slug}
                title={post.data.title}
                summary={post.data.summary}
                pubDate={post.data.pubDate}
                updatedDate={post.data.updatedDate}
                tags={post.data.tags}
              />
            ))
          }
        </div>
        {
          blogPosts.length > 0 && (
            <a href="/blog/" class="btn-solid-red mt-8">
              All Posts
            </a>
          )
        }
      </RevealOnScroll>
    </div>
  </section>

  <section class="mx-auto max-w-5xl px-4 py-16 sm:px-6 lg:px-8">
    <RevealOnScroll>
      <h2 class="section-heading-rosie mb-8">Contact</h2>
      <p class="max-w-2xl text-muted">Checkout my work on GitHub.</p>
      <a
        href="https://github.com/therivetedrose"
        class="btn-github mt-4"
        target="_blank"
        rel="noopener noreferrer"
      >
        <GitHubIcon size={18} />
        GitHub
      </a>
      <p class="mt-6 text-muted">Reach out to me on LinkedIn.</p>
      <a
        href="https://www.linkedin.com/in/rosefr"
        class="btn-linkedin mt-4"
        target="_blank"
        rel="noopener noreferrer"
      >
        <LinkedInIcon size={18} />
        LinkedIn
      </a>
    </RevealOnScroll>
  </section>
</PageLayout>
